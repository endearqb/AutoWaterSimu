日期：2026-02-13

内容：
  - 新增功能：
    - 在右侧“连接参数设置”中新增“时间分段设置”入口，支持在连接参数面板内直接编辑时段起止时间与 `flow/a/b` 分段覆盖值。
    - 当首次开启右侧时段编辑且当前无时段时，自动创建默认时段 `[0, hours]`，降低初始配置成本。
  - 改进：
    - 右侧时段编辑已接入 ASM1/ASM1Slim/ASM3/UDM，多个连接线共享同一组时段结构，未覆盖项默认继承。
    - 继承展示从“继承”占位改为“直接显示继承数值 + 灰色继承标识”，并支持清空输入恢复继承。
    - 连接参数面板在时段编辑模式下可按时段数量向左扩展，最大到画布宽度 80%，超出后使用横向滚动。
    - 时段标题移除动态 `seg_xxx` 标识，统一显示序号（如“时段 1”）；上移/下移/复制/删除改为无边框 icon 按钮。
  - 改进：
    - 调整 ASM 时段计划弹窗布局为画布居中显示，宽度与高度均按画布 80% 计算，并保持窗口内纵向滚动。
    - 时段计划中边名称展示改为“节点名称 -> 节点名称”（优先使用节点 label）。
    - 重构时段参数编辑区布局为“不同边上下排列、同一边不同时段水平排列”，提升跨时段对比效率。
    - 时段计划窗口支持滚动时固定顶部时段编辑区域，便于长表编辑。
  - 修复：
    - 修复“添加边覆盖”后输入区未显示的问题（空覆盖被立即清理导致 flow/a/b 无法录入）。
  - 文档：
    - 新增 `docs/hybrid_udm_requirement_2026-02-13.md`，明确 Hybrid 一期仅接入 UDM、模型对全局映射、变量重叠与非重叠计算语义。
    - 新增 `docs/hybrid_udm_dev_plan_2026-02-13.md`，给出前后端分阶段开发拆解、测试计划与 OpenAPI 客户端更新流程。
  - 新增功能：
    - 后端新增 Hybrid UDM 映射校验与编译服务：支持 `selected_models` / `model_pair_mappings` 校验、焦集变量覆盖检查、图连边所需模型对检查、节点级变量绑定编译。
    - 后端新增 `POST /api/v1/udm/validate-hybrid-flowchart` 接口；`/calculate-from-flowchart` 增加 Hybrid 严格校验并在失败时返回 `HYBRID_UDM_VALIDATION_FAILED`。
    - UDM 计算引擎支持“局部变量 -> 全局规范变量”投影，反应项在节点局部符号空间计算后回写到全局分量向量。
    - 前端新增 Hybrid Setup 对话框（UDM 多模型选择 + 模型对映射 + local exempt）并持久化到 `flow_data.hybrid_config`。
    - 前端 UDM 属性面板新增 Hybrid 节点模型绑定下拉，切换模型时自动同步节点 `udmModel/udmModelSnapshot/udmModelId/udmModelVersion` 等快照字段。
  - 改进：
    - 提交仿真前（UDM 且 Hybrid 模式）前端先调用 Hybrid 校验接口，先行阻断无效映射并回显错误，减少无效任务提交。
    - 更新 OpenAPI 并重新生成 `frontend/src/client`，同步 Hybrid 相关 schema 与 SDK。
  - 修复：
    - 修复 `UDMPropertyPanel.tsx` 导入损坏导致的前端编译错误。
    - 修复 `HybridUDMSetupDialog.tsx` 中 JSX 文本箭头写法引发的 TypeScript 语法错误。
  - 改进：
    - 完成 Hybrid UDM 前端文案国际化：`UDMPropertyPanel`、`HybridUDMSetupDialog`、`UDMBubbleMenu` 的新增文案全部切换为 i18n key。
    - 补齐 `frontend/src/i18n/messages/en.ts`、`frontend/src/i18n/messages/zh.ts` 与 `frontend/src/i18n/types.ts` 的 Hybrid 文案与类型定义。
  - 收尾：
    - 按当前环境约束取消前端集成测试补充，移除临时 Playwright 用例与测试专用 `data-testid` 注入，仅保留国际化与功能主线改动。
