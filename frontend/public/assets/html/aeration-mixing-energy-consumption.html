<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>活性污泥工艺优化模拟器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Harmony -->
    <!-- Application Structure Plan: 本应用采用单页仪表盘式布局，顶部设有导航栏，可快速跳转至不同功能模块。这种非线性结构旨在将复杂的报告内容转化为一个探索式工具。1. 核心关系仪表盘：此为应用核心，用户通过一个主滑块（MLSS）来实时驱动三个关联图表（能耗、SVI、成本）的变化，直观地揭示报告中最关键的“权衡”概念。2. 设计模拟器：一个任务导向的计算工具，让用户能代入自己的数据，将抽象的理论付诸实践，增强参与感和理解。3. 优化策略卡片：将报告中的定性建议整理为简洁的卡片式布局，便于阅读和吸收。4. 关键参数速查：提供一个简洁的参考区域。此结构优先考虑“互动中学习”，通过可视化和直接操控，使用户能够主动探索和理解参数间的复杂关系，而非被动阅读。 -->
    <!-- Visualization & Content Choices: 1. MLSS vs. 能耗: 目标是展示能耗随MLSS非线性增长。选用Chart.js线图，通过主滑块互动更新，此方式能动态展示变量关系，比静态文字更具冲击力。2. P/V vs. SVI: 目标是揭示混合强度与絮体沉降性的“最佳平衡点”。选用U型曲线图，通过滑块互动，并附带定性文字反馈（如“沉降风险”、“最佳混合”），清晰传达过高或过低混合的负面影响。3. 优化策略: 目标是呈现关键改进措施。选用HTML/CSS构建的卡片式布局，将大段文字分解为易于消化的知识点，提升可读性。4. 关键参数: 目标是提供便捷的定义查询。选用简洁的双栏布局，作为上下文参考，避免主界面信息过载。所有图表和动态元素均使用Chart.js和原生JS实现，确保无SVG或Mermaid依赖。 -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Noto Sans SC', sans-serif; background-color: #f8fafc; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto; height: 300px; max-height: 350px; }
        @media (min-width: 768px) { .chart-container { height: 350px; max-height: 400px; } }
        .nav-link { transition: color 0.3s, border-bottom-color 0.3s; }
        .nav-link:hover, .nav-link.active { color: #2563eb; border-bottom-color: #2563eb; }
        .card { transition: transform 0.3s, box-shadow 0.3s; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-md">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl md:text-2xl font-bold text-blue-600">活性污泥工艺优化模拟器</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#interactive-dashboard" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 border-b-2 border-transparent">核心关系仪表盘</a>
                        <a href="#design-simulator" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 border-b-2 border-transparent">设计模拟器</a>
                        <a href="#optimization-strategies" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 border-b-2 border-transparent">优化策略</a>
                        <a href="#key-parameters" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 border-b-2 border-transparent">关键参数</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 sm:p-6 lg:p-8">
        
        <section id="interactive-dashboard" class="mb-16 scroll-mt-24">
            <h2 class="text-3xl font-bold text-center mb-4 text-slate-900">核心关系仪表盘</h2>
            <p class="text-center max-w-3xl mx-auto text-slate-600 mb-12">
                活性污泥工艺的优化在于精妙的平衡。此仪表盘旨在揭示关键参数间的相互制约关系。通过下方的滑块调整污泥浓度（MLSS），观察其如何联动影响曝气与混合能耗、污泥沉降性能（SVI）以及最终的运行成本。这模拟了现实世界中操作决策的连锁反应。
            </p>

            <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-200 mb-12">
                <label for="mlss-slider" class="block text-lg font-medium text-slate-700 mb-2">调整运行污泥浓度 (MLSS)</label>
                <div class="flex items-center space-x-4">
                    <span class="text-sm text-slate-500">1500 mg/L</span>
                    <input id="mlss-slider" type="range" min="1500" max="8000" value="3500" step="50" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                    <span class="text-sm text-slate-500">8000 mg/L</span>
                </div>
                <div class="text-center mt-4">
                    <span class="text-2xl font-bold text-blue-600" id="mlss-value">3500</span>
                    <span class="text-slate-600">mg/L</span>
                </div>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
                    <h3 class="text-xl font-semibold mb-4 text-center">能耗 vs. MLSS</h3>
                    <div class="chart-container">
                        <canvas id="powerChart"></canvas>
                    </div>
                    <p class="text-sm text-slate-500 mt-4">随着MLSS升高，为满足生物耗氧（OUR）和克服流体粘度，曝气与混合功率需求呈非线性急剧增长，这是主要的能耗代价。</p>
                </div>

                <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
                    <h3 class="text-xl font-semibold mb-4 text-center">SVI vs. 混合强度 (P/V)</h3>
                     <div class="chart-container">
                        <canvas id="sviChart"></canvas>
                    </div>
                    <p class="text-sm text-slate-500 mt-4">混合强度存在“最佳窗口”。过低导致污泥沉积，过高则会破坏絮体结构，两者均会恶化沉降性能，导致SVI升高。</p>
                </div>

                <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-200 md:col-span-2 lg:col-span-1">
                    <h3 class="text-xl font-semibold mb-4 text-center">运行成本分析</h3>
                    <div class="chart-container">
                        <canvas id="costChart"></canvas>
                    </div>
                    <p class="text-sm text-slate-500 mt-4">综合能耗与潜在的药剂费用（如因SVI过高投加聚合物），总运行成本随MLSS变化。寻找成本曲线的最低点是经济优化的核心目标。</p>
                </div>
            </div>
        </section>

        <section id="design-simulator" class="mb-16 scroll-mt-24">
            <h2 class="text-3xl font-bold text-center mb-4 text-slate-900">设计模拟器</h2>
            <p class="text-center max-w-3xl mx-auto text-slate-600 mb-12">
                将理论应用于实践。输入您的（或设想的）反应池参数，本工具将根据报告中的经验模型，估算维持污泥悬浮所需的混合功率密度（P/V）。这有助于您快速评估不同设计方案的能耗水平，并理解高MLSS对混合系统设计的直接挑战。
            </p>
            <div class="max-w-xl mx-auto bg-white p-8 rounded-2xl shadow-lg border border-slate-200">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="tank-volume" class="block text-sm font-medium text-slate-700">反应池容积 (V)</label>
                        <div class="mt-1 relative rounded-md shadow-sm">
                            <input type="number" id="tank-volume" value="5000" class="block w-full pl-4 pr-12 border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                <span class="text-slate-500 sm:text-sm">m³</span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label for="mixer-power" class="block text-sm font-medium text-slate-700">搅拌机轴功率 (P₀)</label>
                         <div class="mt-1 relative rounded-md shadow-sm">
                            <input type="number" id="mixer-power" value="15" class="block w-full pl-4 pr-12 border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                <span class="text-slate-500 sm:text-sm">kW</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mt-8 pt-6 border-t border-slate-200">
                    <h4 class="text-lg font-semibold text-center">估算结果</h4>
                    <div class="mt-4 text-center bg-slate-100 p-6 rounded-lg">
                        <p class="text-slate-600">混合功率密度 (P/V)</p>
                        <p class="text-4xl font-bold text-blue-600 my-2" id="pv-result">3.00</p>
                        <p class="text-slate-600">W/m³</p>
                        <p class="mt-4 text-sm font-medium" id="pv-comment">适用于常规市政污泥浓度。</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="optimization-strategies" class="mb-16 scroll-mt-24">
            <h2 class="text-3xl font-bold text-center mb-4 text-slate-900">优化策略精粹</h2>
            <p class="text-center max-w-3xl mx-auto text-slate-600 mb-12">
                节能增效不仅是调整单个参数，更是一套系统性的方法论。以下是从报告中提炼的关键优化策略，涵盖了从宏观工艺调控到微观设备选型的核心思想，旨在帮助您构建一个更稳定、更经济的运行体系。
            </p>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="card bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
                    <h3 class="font-bold text-xl mb-3 text-blue-700">SRT/F&M 比调控</h3>
                    <p class="text-slate-600">通过控制污泥龄(SRT)和食微比(F/M)，可以主动塑造微生物群落结构，培养出絮凝性好、沉降性能优良的活性污泥，这是从根源上优化SVI、降低后续处理难度和能耗的根本策略。</p>
                </div>
                 <div class="card bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
                    <h3 class="font-bold text-xl mb-3 text-blue-700">低剪切混合技术</h3>
                    <p class="text-slate-600">优先选择大叶轮、低转速的搅拌设备。这种“高流量、低湍流”的混合方式，能在保证污泥悬浮的同时，最大限度地保护脆弱的污泥絮体不被破坏，是解决混合与沉降矛盾的关键技术。</p>
                </div>
                <div class="card bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
                    <h3 class="font-bold text-xl mb-3 text-blue-700">动态控制与VFD</h3>
                    <p class="text-slate-600">利用在线DO、MLSS传感器，结合变频驱动器(VFD)，实现对曝气和混合的按需供给。这种自动化控制策略能精准匹配工艺需求，避免在低负荷时段的能源浪费，节能潜力巨大。</p>
                </div>
                <div class="card bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
                    <h3 class="font-bold text-xl mb-3 text-blue-700">CFD 模拟验证</h3>
                    <p class="text-slate-600">对于高浓度或非标准池型的设计，采用计算流体力学(CFD)模拟，可以在设计阶段就识别出混合死区和高剪切区，验证布局方案，是规避设计风险、确保混合效果的强大工具。</p>
                </div>
                 <div class="card bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
                    <h3 class="font-bold text-xl mb-3 text-blue-700">α 因子管理</h3>
                    <p class="text-slate-600">认识到高MLSS会显著降低氧转移效率(α因子)，在设计时必须选用更保守的α值。运行中α值的异常下降可能预示着进水水质变化，是重要的故障诊断指标。</p>
                </div>
                <div class="card bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
                    <h3 class="font-bold text-xl mb-3 text-blue-700">分区与递减曝气</h3>
                    <p class="text-slate-600">在推流式反应器中，根据沿程需氧量的变化，前端多曝气、后端少曝气。这种“递减曝气”设计使供氧与需氧更匹配，显著提升能源利用效率。</p>
                </div>
            </div>
        </section>

        <section id="key-parameters" class="scroll-mt-24">
            <h2 class="text-3xl font-bold text-center mb-4 text-slate-900">关键参数速查</h2>
            <p class="text-center max-w-3xl mx-auto text-slate-600 mb-12">
                温故而知新。这里汇集了本应用及报告中涉及的核心技术术语。清晰地理解每一个参数的定义及其在工艺中的作用，是做出正确操作决策的基础。
            </p>
            <div class="bg-white rounded-2xl shadow-lg border border-slate-200 divide-y divide-slate-200">
                <div class="p-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                    <h4 class="font-semibold text-slate-800 md:col-span-1">MLSS (混合液悬浮固体)</h4>
                    <p class="text-slate-600 md:col-span-2">曝气池中总固体（有机+无机）的浓度，单位mg/L。是衡量生物反应器内生物量的核心指标，直接影响需氧量和混合液物理特性。</p>
                </div>
                <div class="p-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                    <h4 class="font-semibold text-slate-800 md:col-span-1">SVI (污泥体积指数)</h4>
                    <p class="text-slate-600 md:col-span-2">衡量污泥沉降压缩性能的指标，单位mL/g。SVI在80-150之间为佳。过高表示污泥膨胀，沉降困难；过低则可能絮体细小。</p>
                </div>
                <div class="p-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                    <h4 class="font-semibold text-slate-800 md:col-span-1">P/V (功率密度)</h4>
                    <p class="text-slate-600 md:col-span-2">输入搅拌机的功率与池体容积之比，单位W/m³。是表征混合强度的传统指标。高浓度污泥需要更高的P/V值来维持悬浮。</p>
                </div>
                 <div class="p-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                    <h4 class="font-semibold text-slate-800 md:col-span-1">OUR (耗氧速率)</h4>
                    <p class="text-slate-600 md:col-span-2">单位时间内单位体积混合液消耗的氧气量，单位mg/L/hr。它直接反映了微生物的实时生物活性和代谢负荷。</p>
                </div>
                <div class="p-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                    <h4 class="font-semibold text-slate-800 md:col-span-1">α (Alpha) 因子</h4>
                    <p class="text-slate-600 md:col-span-2">废水中的氧总转移系数与清水中的氧总转移系数之比，无量纲。它量化了污水中污染物（特别是MLSS和表面活性剂）对曝气效率的抑制程度。</p>
                </div>
            </div>
        </section>
    </main>
    
    <footer class="bg-slate-800 text-slate-400 mt-16">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 text-center text-sm">
            <p>&copy; 2025 活性污泥工艺优化模拟器。基于技术报告分析生成，仅供教学与研究目的。</p>
        </div>
    </footer>

<script>
document.addEventListener('DOMContentLoaded', () => {

    const mlssSlider = document.getElementById('mlss-slider');
    const mlssValueSpan = document.getElementById('mlss-value');

    const tankVolumeInput = document.getElementById('tank-volume');
    const mixerPowerInput = document.getElementById('mixer-power');
    const pvResultSpan = document.getElementById('pv-result');
    const pvCommentSpan = document.getElementById('pv-comment');

    let powerChart, sviChart, costChart;

    const mlssData = Array.from({ length: (8000 - 1500) / 50 + 1 }, (_, i) => 1500 + i * 50);

    const calculatePower = (mlss) => {
        const basePower = 10;
        const mlssFactor = Math.pow(mlss / 1000, 2);
        return basePower + mlssFactor; 
    };
    
    const calculateSVI = (pv) => {
        const optimalPV = 3.5;
        const baseSVI = 100;
        const deviation = Math.abs(pv - optimalPV);
        return baseSVI + Math.pow(deviation, 2) * 8 + (pv > optimalPV ? (pv - optimalPV) * 5 : 0);
    };

    const calculateCost = (power, svi) => {
        const powerCostFactor = 0.5;
        const sviPenaltyFactor = 0.1;
        const baseCost = 20;
        let sviPenalty = (svi > 150) ? Math.pow((svi - 150) / 10, 2) : 0;
        return baseCost + power * powerCostFactor + sviPenalty * sviPenaltyFactor;
    };

    const initCharts = () => {
        const powerCtx = document.getElementById('powerChart').getContext('2d');
        powerChart = new Chart(powerCtx, {
            type: 'line',
            data: {
                labels: mlssData,
                datasets: [{
                    label: '总能耗指数',
                    data: mlssData.map(calculatePower),
                    borderColor: '#3b82f6',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    borderWidth: 2,
                    pointRadius: 0,
                    tension: 0.4,
                    fill: true,
                }]
            },
            options: chartOptions('MLSS (mg/L)', '相对能耗指数')
        });

        const pvData = Array.from({ length: (6 - 1) / 0.1 + 1 }, (_, i) => 1 + i * 0.1);
        const sviCtx = document.getElementById('sviChart').getContext('2d');
        sviChart = new Chart(sviCtx, {
            type: 'line',
            data: {
                labels: pvData.map(p => p.toFixed(1)),
                datasets: [{
                    label: 'SVI (mL/g)',
                    data: pvData.map(calculateSVI),
                    borderColor: '#10b981',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    borderWidth: 2,
                    pointRadius: 0,
                    tension: 0.4,
                    fill: true,
                }]
            },
            options: chartOptions('混合功率密度 P/V (W/m³)', 'SVI (mL/g)')
        });
        
        const costCtx = document.getElementById('costChart').getContext('2d');
        costChart = new Chart(costCtx, {
            type: 'bar',
            data: {
                labels: ['曝气', '混合', '药剂/风险'],
                datasets: [{
                    label: '相对成本构成',
                    data: [60, 30, 10],
                    backgroundColor: ['#60a5fa', '#3b82f6', '#f59e0b'],
                    borderRadius: 4,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: '相对运行成本构成' }
                },
                scales: {
                    x: { stacked: true, title: { display: true, text: '成本比例' } },
                    y: { stacked: true }
                }
            }
        });
    };

    const chartOptions = (xLabel, yLabel) => ({
        responsive: true,
        maintainAspectRatio: false,
        interaction: {
            intersect: false,
            mode: 'index',
        },
        plugins: {
            legend: { display: false },
            tooltip: {
                enabled: true,
                mode: 'index',
                intersect: false,
            },
        },
        scales: {
            x: {
                title: { display: true, text: xLabel, font: {size: 10} },
                ticks: {
                    maxTicksLimit: 6,
                    font: { size: 10 }
                }
            },
            y: {
                title: { display: true, text: yLabel, font: {size: 10} },
                ticks: {
                    font: { size: 10 }
                }
            }
        }
    });
    
    let activePointPower;
    const updateCharts = () => {
        const mlss = parseInt(mlssSlider.value);
        mlssValueSpan.textContent = mlss;
        
        const currentPower = calculatePower(mlss);
        
        if (!activePointPower) {
            activePointPower = {
                type: 'point',
                xValue: mlss,
                yValue: currentPower,
                backgroundColor: 'red',
                radius: 6,
                borderColor: 'white',
                borderWidth: 2,
            };
            powerChart.options.plugins.annotation = { annotations: { point1: activePointPower } };
        } else {
            activePointPower.xValue = mlss;
            activePointPower.yValue = currentPower;
        }

        powerChart.update();
        
        const pv = parseFloat(pvResultSpan.textContent);
        const svi = calculateSVI(pv);

        const powerCost = currentPower * 0.4;
        const mixingCost = pv * 5;
        const riskCost = (svi > 150 ? (svi - 150) / 5 : 0);
        
        costChart.data.datasets[0].data = [powerCost, mixingCost, riskCost];
        costChart.update();
    };

    const updatePV = () => {
        const volume = parseFloat(tankVolumeInput.value);
        const power = parseFloat(mixerPowerInput.value);
        if (isNaN(volume) || isNaN(power) || volume <= 0) {
            pvResultSpan.textContent = 'N/A';
            pvCommentSpan.textContent = '请输入有效的容积和功率。';
            return;
        }

        const pv = (power * 1000) / volume;
        pvResultSpan.textContent = pv.toFixed(2);
        
        let comment = '';
        if (pv < 1.5) comment = '混合强度过低，有污泥沉积风险。';
        else if (pv <= 3.0) comment = '适用于常规市政污泥浓度。';
        else if (pv <= 6.0) comment = '适用于较高浓度或工业废水。';
        else comment = '高功率混合，需注意对絮体的剪切破坏。';
        pvCommentSpan.textContent = comment;
        
        updateCharts();
    };

    mlssSlider.addEventListener('input', updateCharts);
    tankVolumeInput.addEventListener('input', updatePV);
    mixerPowerInput.addEventListener('input', updatePV);
    
    const navLinks = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('main section');

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href').substring(1) === entry.target.id) {
                        link.classList.add('active');
                    }
                });
            }
        });
    }, { rootMargin: "-50% 0px -50% 0px" });

    sections.forEach(section => {
        observer.observe(section);
    });

    initCharts();
    updatePV();
});
</script>

</body>
</html>
