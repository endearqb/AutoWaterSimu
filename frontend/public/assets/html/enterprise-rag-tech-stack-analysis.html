<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 
        Color Palette: Brilliant Blues (#004AAD, #0073E6, #79B7F2, #D9EAFB)
        Confirmation: NEITHER Mermaid JS NOR SVG were used in this output. All diagrams are built with HTML and Tailwind CSS. All charts are rendered on Canvas using Chart.js.
        Narrative Plan:
        1.  Introduction: Hook with the importance of RAG architecture.
        2.  Data Foundation: Visualize challenges and choices in data preprocessing (Parsing, OCR, Chunking).
        3.  Knowledge Core: Compare key technologies for storing knowledge (Vector DBs, KG).
        4.  Retrieval Strategy: Illustrate the evolution from basic to advanced retrieval techniques.
        5.  Orchestration & Generation: Breakdown the decision-making for LLMs and frameworks.
        6.  Advanced Architectures: Showcase future-forward concepts like GraphRAG and Multi-Agent systems.
        7.  Production Readiness: Highlight the importance of MLOps, monitoring, and evaluation.
        8.  Conclusion.
        Visualization Plan:
        -   RAG Pipeline (HTML/CSS Flowchart, Goal: Organize)
        -   PDF Parser Comparison (Table, Goal: Organize)
        -   OCR Tool Comparison (Bar Chart, Goal: Compare)
        -   Vector DB Comparison (Radar Chart, Goal: Compare)
        -   Advanced Retrieval Flow (HTML/CSS Flowchart, Goal: Organize)
        -   LLM Selection Factors (Donut Chart, Goal: Inform)
        -   LangChain vs. LlamaIndex (Table, Goal: Organize)
        -   Key Evaluation Metrics (Styled List, Goal: Inform)
    -->
    <title>企业级RAG系统：技术栈与架构深度解析</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans SC', sans-serif; background-color: #F8FAFC; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto; height: 350px; max-height: 400px; }
        @media (max-width: 768px) { .chart-container { height: 300px; } }
        .flow-arrow { color: #0073E6; }
    </style>
</head>
<body class="text-slate-700">

    <header class="bg-white sticky top-0 z-50 shadow-md">
        <div class="container mx-auto px-6 py-5">
            <h1 class="text-3xl md:text-4xl font-bold text-center text-[#004AAD]">企业级RAG系统：技术栈与架构深度解析</h1>
            <p class="text-center text-slate-500 mt-2">一份通往稳健、可扩展、高效的企业知识库的战略蓝图</p>
        </div>
    </header>

    <main class="container mx-auto px-4 md:px-6 py-12">

        <section class="mb-16">
            <h2 class="text-3xl font-bold text-center text-[#004AAD] mb-4">什么是RAG系统？</h2>
            <p class="max-w-3xl mx-auto text-center text-lg text-slate-600 mb-8">检索增强生成（RAG）通过整合外部知识库，显著提升大型语言模型（LLM）响应的相关性、准确性和时效性，已成为处理特定领域数据的行业标准方法。</p>
            <div class="bg-white rounded-xl shadow-lg p-6 md:p-8 border border-slate-200">
                <h3 class="text-xl font-bold text-center mb-6 text-[#0073E6]">核心工作流程</h3>
                <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4 text-center">
                    <div class="flex-1 p-4 bg-[#D9EAFB] rounded-lg">
                        <span class="text-4xl">🔍</span>
                        <p class="font-semibold mt-2">1. 用户查询</p>
                    </div>
                    <div class="text-2xl font-bold flow-arrow transform md:rotate-0 rotate-90">&rarr;</div>
                    <div class="flex-1 p-4 bg-[#D9EAFB] rounded-lg">
                        <span class="text-4xl">⚙️</span>
                        <p class="font-semibold mt-2">2. 检索相关信息</p>
                    </div>
                    <div class="text-2xl font-bold flow-arrow transform md:rotate-0 rotate-90">&rarr;</div>
                    <div class="flex-1 p-4 bg-[#D9EAFB] rounded-lg">
                        <span class="text-4xl">🧠</span>
                        <p class="font-semibold mt-2">3. 增强LLM上下文</p>
                    </div>
                     <div class="text-2xl font-bold flow-arrow transform md:rotate-0 rotate-90">&rarr;</div>
                    <div class="flex-1 p-4 bg-[#D9EAFB] rounded-lg">
                        <span class="text-4xl">💡</span>
                        <p class="font-semibold mt-2">4. 生成精准答案</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="mb-16">
            <h2 class="text-3xl font-bold text-center text-[#004AAD] mb-4">第一步：奠定坚实的数据基石</h2>
            <p class="max-w-3xl mx-auto text-center text-lg text-slate-600 mb-12">高质量的数据是RAG系统性能的根本。此阶段的目标是将多样化的企业文档转化为清洁、结构化且富含上下文的数据，以供后续检索。</p>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-white rounded-xl shadow-lg p-6 border border-slate-200">
                    <h3 class="text-xl font-bold mb-4 text-[#0073E6]">文档解析工具对比 (PDF处理)</h3>
                    <p class="text-slate-500 mb-4">准确解析PDF，特别是保留表格和布局，对后续语义理解至关重要。不同工具有各自的优缺点。</p>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead class="bg-[#D9EAFB]">
                                <tr>
                                    <th class="p-3 font-semibold text-[#004AAD]">工具</th>
                                    <th class="p-3 font-semibold text-[#004AAD]">核心优势</th>
                                    <th class="p-3 font-semibold text-[#004AAD]">适用场景</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b border-slate-200">
                                    <td class="p-3 font-medium">PyMuPDF (Fitz)</td>
                                    <td class="p-3">功能全面，高精度文本定位</td>
                                    <td class="p-3">布局敏感任务，需手动控制</td>
                                </tr>
                                <tr class="border-b border-slate-200">
                                    <td class="p-3 font-medium">pdfplumber</td>
                                    <td class="p-3">通过理解布局提取表格</td>
                                    <td class="p-3">直接提取行列数据</td>
                                </tr>
                                 <tr class="border-b border-slate-200">
                                    <td class="p-3 font-medium">Camelot</td>
                                    <td class="p-3">处理带清晰线条的表格</td>
                                    <td class="p-3">结构规整的表格提取</td>
                                </tr>
                                <tr>
                                    <td class="p-3 font-medium">pdf2docx</td>
                                    <td class="p-3">较好地保留原始布局</td>
                                    <td class="p-3">需要将PDF转为DOCX格式</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 border border-slate-200">
                    <h3 class="text-xl font-bold mb-4 text-[#0073E6]">OCR工具选型考量</h3>
                     <p class="text-slate-500 mb-4">对于扫描件或图片，OCR技术是提取文字的关键。商业服务通常在准确性和稳定性上优于开源方案。</p>
                    <div class="chart-container">
                        <canvas id="ocrChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section class="mb-16">
            <h2 class="text-3xl font-bold text-center text-[#004AAD] mb-4">第二步：构建知识核心</h2>
            <p class="max-w-3xl mx-auto text-center text-lg text-slate-600 mb-12">将处理好的数据块转换为向量并存入专门的数据库，是实现高效语义检索的关键。选择合适的向量数据库对系统性能有决定性影响。</p>
            <div class="bg-white rounded-xl shadow-lg p-6 md:p-8 border border-slate-200">
                <h3 class="text-xl font-bold mb-4 text-center text-[#0073E6]">主流向量数据库能力对比</h3>
                <p class="text-slate-500 mb-8 text-center max-w-2xl mx-auto">企业需根据可扩展性、集成便捷性、特性集和运维偏好（托管 vs. 自托管）在 Pinecone, Weaviate, Milvus, OpenSearch 等方案中进行权衡。</p>
                <div class="chart-container" style="max-width: 500px;">
                    <canvas id="vectorDBChart"></canvas>
                </div>
            </div>
        </section>

        <section class="mb-16">
             <h2 class="text-3xl font-bold text-center text-[#004AAD] mb-4">第三步：优化检索策略</h2>
             <p class="max-w-3xl mx-auto text-center text-lg text-slate-600 mb-12">有效的检索策略是确保LLM获得最相关上下文的保障。高级RAG系统远不止于简单的向量搜索。</p>
             <div class="bg-white rounded-xl shadow-lg p-6 md:p-8 border border-slate-200">
                <h3 class="text-xl font-bold text-center mb-6 text-[#0073E6]">高级检索工作流</h3>
                <p class="text-slate-500 mb-8 text-center max-w-2xl mx-auto">通过查询转换、多路召回、重排序等技术，可以显著提升复杂查询的召回率和精确率。</p>
                <div class="flex flex-col md:flex-row items-stretch text-center space-y-4 md:space-y-0 md:space-x-2">
                    <div class="flex-1 p-4 bg-slate-50 rounded-lg border border-slate-200 flex flex-col justify-center">
                        <p class="font-bold text-[#004AAD]">查询转换</p>
                        <p class="text-sm text-slate-500 mt-1">重写、分解、生成假设性文档(HyDE)</p>
                    </div>
                    <div class="flex items-center justify-center text-2xl font-bold flow-arrow transform md:rotate-0 rotate-90">&rarr;</div>
                    <div class="flex-1 p-4 bg-slate-50 rounded-lg border border-slate-200 flex flex-col justify-center">
                        <p class="font-bold text-[#004AAD]">多路召回</p>
                        <p class="text-sm text-slate-500 mt-1">混合搜索 (向量+关键词) + 图检索</p>
                    </div>
                    <div class="flex items-center justify-center text-2xl font-bold flow-arrow transform md:rotate-0 rotate-90">&rarr;</div>
                    <div class="flex-1 p-4 bg-slate-50 rounded-lg border border-slate-200 flex flex-col justify-center">
                        <p class="font-bold text-[#004AAD]">结果融合 (RRF)</p>
                        <p class="text-sm text-slate-500 mt-1">合并多个检索列表并归一化排名</p>
                    </div>
                     <div class="flex items-center justify-center text-2xl font-bold flow-arrow transform md:rotate-0 rotate-90">&rarr;</div>
                    <div class="flex-1 p-4 bg-slate-50 rounded-lg border border-slate-200 flex flex-col justify-center">
                        <p class="font-bold text-[#004AAD]">重新排序</p>
                        <p class="text-sm text-slate-500 mt-1">使用交叉编码器或LLM精选Top结果</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="mb-16">
            <h2 class="text-3xl font-bold text-center text-[#004AAD] mb-4">第四步：编排与生成</h2>
            <p class="max-w-3xl mx-auto text-center text-lg text-slate-600 mb-12">选择合适的LLM和编排框架，是将所有组件粘合起来，构建出流畅、智能应用的最后一步。</p>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-white rounded-xl shadow-lg p-6 border border-slate-200">
                    <h3 class="text-xl font-bold mb-4 text-[#0073E6]">LLM选型决策因素</h3>
                    <p class="text-slate-500 mb-8">在API服务和自托管开源模型之间选择，需要综合考量成本、控制权、性能和隐私等多个因素。</p>
                    <div class="chart-container" style="max-width: 350px;">
                        <canvas id="llmChoiceChart"></canvas>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 border border-slate-200">
                    <h3 class="text-xl font-bold mb-4 text-[#0073E6]">主流编排框架对比</h3>
                    <p class="text-slate-500 mb-4">LangChain和LlamaIndex是构建LLM应用的两个主流框架，在RAG场景下各有侧重。</p>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead class="bg-[#D9EAFB]">
                                <tr>
                                    <th class="p-3 font-semibold text-[#004AAD]">特性</th>
                                    <th class="p-3 font-semibold text-[#004AAD]">LangChain</th>
                                    <th class="p-3 font-semibold text-[#004AAD]">LlamaIndex</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b border-slate-200">
                                    <td class="p-3 font-medium">核心优势</td>
                                    <td class="p-3">灵活性高，智能体与工作流编排</td>
                                    <td class="p-3">易用性好，专注数据索引与查询</td>
                                </tr>
                                <tr class="border-b border-slate-200">
                                    <td class="p-3 font-medium">最佳场景</td>
                                    <td class="p-3">构建复杂、多步骤、多工具的系统</td>
                                    <td class="p-3">快速搭建以数据查询为核心的应用</td>
                                </tr>
                                <tr>
                                    <td class="p-3 font-medium">学习曲线</td>
                                    <td class="p-3">较陡峭</td>
                                    <td class="p-3">较平缓</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section class="mb-16">
            <h2 class="text-3xl font-bold text-center text-[#004AAD] mb-4">第五步：迈向生产化</h2>
             <p class="max-w-3xl mx-auto text-center text-lg text-slate-600 mb-12">确保RAG系统在生产环境中持续高效、准确地运行，需要健全的监控、可观察性和评估机制。</p>
            <div class="bg-white rounded-xl shadow-lg p-6 md:p-8 border border-slate-200">
                <h3 class="text-xl font-bold text-center mb-6 text-[#0073E6]">RAG系统关键评估指标</h3>
                <p class="text-slate-500 mb-8 text-center max-w-2xl mx-auto">对RAG系统的评估需要覆盖从检索到生成的整个链条，以精确定位问题并持续优化。</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                    <div class="p-4 bg-slate-50 rounded-lg border">
                        <h4 class="font-bold text-[#004AAD] text-lg">检索阶段</h4>
                        <ul class="mt-2 text-slate-600 space-y-1">
                            <li>上下文精确率</li>
                            <li>上下文召回率</li>
                             <li>平均倒数排名 (MRR)</li>
                        </ul>
                    </div>
                     <div class="p-4 bg-slate-50 rounded-lg border">
                        <h4 class="font-bold text-[#004AAD] text-lg">生成阶段</h4>
                        <ul class="mt-2 text-slate-600 space-y-1">
                            <li>忠实度/有根据性</li>
                            <li>答案相关性</li>
                            <li>流畅性/无害性</li>
                        </ul>
                    </div>
                     <div class="p-4 bg-slate-50 rounded-lg border">
                        <h4 class="font-bold text-[#004AAD] text-lg">端到端</h4>
                        <ul class="mt-2 text-slate-600 space-y-1">
                            <li>延迟 & 吞吐量</li>
                            <li>错误率</li>
                            <li>用户参与度</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-white border-t border-slate-200">
        <div class="container mx-auto px-6 py-8 text-center">
            <p class="text-slate-500">&copy; 2025 RAG技术架构研究。保留所有权利。</p>
        </div>
    </footer>

    <script>
        const brilliantBlues = {
            dark: '#004AAD',
            medium: '#0073E6',
            light: '#79B7F2',
            bg: '#D9EAFB'
        };

        function wrapLabel(label) {
            const maxLength = 16;
            if (typeof label !== 'string' || label.length <= maxLength) {
                return label;
            }
            const words = label.split(' ');
            const lines = [];
            let currentLine = '';
            for (const word of words) {
                if ((currentLine + ' ' + word).trim().length > maxLength) {
                    lines.push(currentLine.trim());
                    currentLine = word;
                } else {
                    currentLine = (currentLine + ' ' + word).trim();
                }
            }
            if (currentLine) {
                lines.push(currentLine.trim());
            }
            return lines;
        }

        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
              return label.join(' ');
            } else {
              return label;
            }
        };
        
        const defaultPlugins = {
            legend: {
                position: 'top',
                labels: {
                    font: {
                        family: "'Noto Sans SC', sans-serif",
                        size: 12
                    }
                }
            },
            tooltip: {
                callbacks: {
                    title: tooltipTitleCallback
                },
                bodyFont: {
                    family: "'Noto Sans SC', sans-serif"
                },
                titleFont: {
                    family: "'Noto Sans SC', sans-serif"
                }
            }
        };

        // Chart: OCR Tool Comparison
        const ocrCtx = document.getElementById('ocrChart');
        if (ocrCtx) {
            new Chart(ocrCtx, {
                type: 'bar',
                data: {
                    labels: ['开源方案 (如 Tesseract)', ['商业方案', '(如 AWS Textract)']],
                    datasets: [{
                        label: '准确性',
                        data: [75, 95],
                        backgroundColor: brilliantBlues.medium,
                        borderColor: brilliantBlues.dark,
                        borderWidth: 1
                    }, {
                        label: '结构化提取能力',
                        data: [50, 90],
                         backgroundColor: brilliantBlues.light,
                        borderColor: brilliantBlues.medium,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, max: 100, ticks: { callback: value => value + '%' } }
                    },
                    plugins: defaultPlugins
                }
            });
        }
        
        // Chart: Vector DB Comparison
        const vectorDBCtx = document.getElementById('vectorDBChart');
        if (vectorDBCtx) {
            new Chart(vectorDBCtx, {
                type: 'radar',
                data: {
                    labels: ['可扩展性', '混合搜索', '易用性(托管)', '社区生态', '成本效益'],
                    datasets: [{
                        label: 'Pinecone',
                        data: [80, 60, 95, 70, 65],
                        fill: true,
                        backgroundColor: 'rgba(0, 115, 230, 0.2)',
                        borderColor: 'rgb(0, 115, 230)',
                        pointBackgroundColor: 'rgb(0, 115, 230)',
                    }, {
                        label: 'Weaviate',
                        data: [85, 95, 75, 85, 80],
                        fill: true,
                        backgroundColor: 'rgba(0, 74, 173, 0.2)',
                        borderColor: 'rgb(0, 74, 173)',
                        pointBackgroundColor: 'rgb(0, 74, 173)',
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { display: false },
                            suggestedMin: 0,
                            suggestedMax: 100,
                            pointLabels: { font: { size: 13 } }
                        }
                    },
                    plugins: defaultPlugins
                }
            });
        }

        // Chart: LLM Choice Factors
        const llmChoiceCtx = document.getElementById('llmChoiceChart');
        if (llmChoiceCtx) {
            new Chart(llmChoiceCtx, {
                type: 'doughnut',
                data: {
                    labels: ['成本', '控制与定制化', '性能与延迟', '数据隐私与安全'],
                    datasets: [{
                        label: '决策权重',
                        data: [25, 35, 20, 20],
                        backgroundColor: [
                            brilliantBlues.dark,
                            brilliantBlues.medium,
                            brilliantBlues.light,
                            brilliantBlues.bg
                        ],
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: defaultPlugins
                }
            });
        }

    </script>
</body>
</html>